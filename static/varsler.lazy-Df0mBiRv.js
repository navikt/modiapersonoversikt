import{$ as h,aK as q,bW as le,bX as ae,bY as ne,bZ as ie,d as oe,b_ as ce,b$ as J,c0 as de,ay as A,t as fe,c1 as me,a1 as y,aW as ue,ap as U,Y as l,c2 as R,aA as $,as as V,ai as C,c3 as he,c4 as ge,c5 as xe,c6 as ve,b2 as je,c7 as pe,c8 as ke,c9 as Ve,bq as Y,be as z,ca as be,bu as I,at as G,cb as K,bJ as P,bb as Se,aq as T,cc as D,a0 as X,ab as ye,aF as _e,bw as H,ae as Ee,cd as Fe,ce as Te,bU as Ne,bV as Re,_ as $e}from"./main-b-impCUS.js";import{S as Z,C as Q,A as Ie}from"./AlertBanner--yDZYgEP.js";import{S as ee}from"./Switch-C5Mm46Du.js";import{P as Le}from"./index-CNK7K_4P.js";import{T as O}from"./Tag-cyIXPrT7.js";import{H as we}from"./HGrid-k-G7xWjv.js";import"./Pagination-B6GxiZe2.js";const De=(t,e)=>{const{kanaler:s,failedVarslerOnly:n,dateRange:a}=e;if(!t||t.length===0)return[];let r=t;return s?.length>0&&(r=r.filter(i=>i.kanaler.some(o=>s.includes(o)))),n&&(r=r.filter(i=>i.harFeilteVarsel)),a?.from&&a?.to&&(r=r.filter(i=>i.datoer.map(d=>oe(d)).some(d=>d.isAfter(a.from)&&d.isBefore(a.to)))),r??[]},w=()=>{const t=h.c(18),e=q(S),s=le();let n;t[0]!==s.data?(n=s?.data??{feil:[],varsler:[]},t[0]=s.data,t[1]=n):n=t[1];const a=n;let r,i;if(t[2]!==e||t[3]!==s||t[4]!==a.varsler){const m=a.varsler.sort(ae(Ce)).map(ze);let c;t[7]!==s?(c=ne(s,ie("varsler")),t[7]=s,t[8]=c):c=t[8];let u;t[9]!==c?(u=[c],t[9]=c,t[10]=u):u=t[10],r=u,i=De(m,e)??[],t[2]=e,t[3]=s,t[4]=a.varsler,t[5]=r,t[6]=i}else r=t[5],i=t[6];const o=s.isLoading;let d;t[11]!==r?(d=r.filter(Boolean),t[11]=r,t[12]=d):d=t[12];let f;return t[13]!==i||t[14]!==d||t[15]!==s.isError||t[16]!==s.isLoading?(f={varsler:i,isLoading:o,errorMessages:d,isError:s.isError},t[13]=i,t[14]=d,t[15]=s.isError,t[16]=s.isLoading,t[17]=f):f=t[17],f},Ae=t=>{const e=t.varslingsTidspunkt,n=`Notifikasjon${t.aktiv?"":" (Ferdigstilt)"}: ${t.tekst}`,a=t.eventId;if(!e||!e.tidspunkt){const d=[t.forstBehandlet],f=["DITT_NAV",...t.eksternVarslingKanaler];return{eventId:a,datoer:d,kanaler:f,tittel:n,sisteDato:d[0],erVarslerV2:!1,event:t}}const r=[e.tidspunkt];e.renotifikasjonTidspunkt&&r.unshift(e.renotifikasjonTidspunkt);const i=["DITT_NAV",...t.eksternVarslingKanaler,...e.renotifikasjonsKanaler].unique(),o=e.harFeilteVarslinger||e.harFeilteRevarslinger;return{eventId:a,datoer:r,kanaler:i,tittel:n,sisteDato:r[0],harFeilteVarsel:o,erVarslerV2:!0,event:t}};function Ce(t){return t.forstBehandlet}function ze(t){return Ae(t)}const te=ce(J.CUSTOM),se=["DITT_NAV","EPOST","SMS"],S=de({dateRange:te,failedVarslerOnly:!1,kanaler:se}),Ke=A(t=>t(S).failedVarslerOnly,(t,e,s)=>{e(S,n=>({...n,failedVarslerOnly:s}))}),Pe=A(t=>t(S).kanaler,(t,e,s)=>{e(S,n=>({...n,kanaler:n.kanaler?fe.xor(n.kanaler,[s]):[s]}))}),He=A(t=>t(S).dateRange,(t,e,s)=>{const n=s??te;e(S,a=>({...a,dateRange:n}))}),Oe=()=>{const t=h.c(3),[e,s]=C(He);let n;return t[0]!==s||t[1]!==e?(n=l.jsx(he,{resettable:!1,range:e,onChange:s,defaultPeriodType:J.CUSTOM}),t[0]=s,t[1]=e,t[2]=n):n=t[2],n},Be=()=>{const t=h.c(7),[e,s]=C(Pe);let n;t[0]!==s?(n=o=>{s(o),ge("varsler",xe.TYPE)},t[0]=s,t[1]=n):n=t[1];const a=n;let r;t[2]!==a||t[3]!==e?(r=se.map(o=>l.jsx(ee,{size:"small",checked:e.includes(o),onChange:()=>a(o),children:o},o)),t[2]=a,t[3]=e,t[4]=r):r=t[4];let i;return t[5]!==r?(i=l.jsx(ve,{size:"small",legend:"Varslingskanal",children:l.jsx(V,{gap:"2",children:r})}),t[5]=r,t[6]=i):i=t[6],i},Me=()=>{const t=h.c(8),[e,s]=C(Ke);let n;t[0]!==s?(n=o=>{s(o)},t[0]=s,t[1]=n):n=t[1];const a=n;let r;t[2]!==e||t[3]!==a?(r=()=>a(!e),t[2]=e,t[3]=a,t[4]=r):r=t[4];let i;return t[5]!==e||t[6]!==r?(i=l.jsx(ee,{size:"small",checked:e,onChange:r,children:"Vis varlser som feilet"}),t[5]=e,t[6]=r,t[7]=i):i=t[7],i},We=()=>{const t=h.c(4),{varsler:e}=w(),s=e.length===1?"varsel":"varsler";let n;t[0]===Symbol.for("react.memo_cache_sentinel")?(n=l.jsx(je,{visuallyHidden:!0,children:"funnet"}),t[0]=n):n=t[0];let a;return t[1]!==s||t[2]!==e.length?(a=l.jsxs(l.Fragment,{children:["Filter (",e.length," ",s,")",n]}),t[1]=s,t[2]=e.length,t[3]=a):a=t[3],a},qe=()=>{const t=h.c(20),e=me(S),[s,n]=y.useState(!1),a=ue(),r=y.useRef(null);let i;t[0]!==e?(i=()=>{e(pe)},t[0]=e,t[1]=i):i=t[1];let o;t[2]!==a?(o=[a],t[2]=a,t[3]=o):o=t[3],y.useEffect(i,o);let d;t[4]!==s?(d=()=>{setTimeout(()=>{if(!r.current)return;const b=r.current.classList.contains("aksel-expansioncard--open");n(b),b!==s&&(b?ke("varselfilter"):Ve("varselfilter"))},0)},t[4]=s,t[5]=d):d=t[5];const f=d;let m;t[6]!==s?(m=s?"100%":{},t[6]=s,t[7]=m):m=t[7];const c=s&&"max-h-full overflow-auto";let u;t[8]!==c?(u=U("rounded-sm",c),t[8]=c,t[9]=u):u=t[9];let g;t[10]===Symbol.for("react.memo_cache_sentinel")?(g=l.jsx(R.Header,{className:"py-0 pr-0 hover:rounded-sm",children:l.jsx(R.Title,{size:"small",as:"h3",className:"text-ax-medium",role:"alert",children:l.jsx(We,{})})}),t[10]=g):g=t[10];let x;t[11]===Symbol.for("react.memo_cache_sentinel")?(x=l.jsx($.New,{maxWidth:"17rem",children:l.jsx(Be,{})}),t[11]=x):x=t[11];let v;t[12]===Symbol.for("react.memo_cache_sentinel")?(v=l.jsx($.New,{maxWidth:"17rem",children:l.jsx(Me,{})}),t[12]=v):v=t[12];let j;t[13]===Symbol.for("react.memo_cache_sentinel")?(j=l.jsx(R.Content,{className:"overflow-visible",children:l.jsxs(V,{gap:"2",children:[x,v,l.jsx($.New,{children:l.jsx(Oe,{})})]})}),t[13]=j):j=t[13];let p;t[14]!==f||t[15]!==u?(p=l.jsxs(R,{size:"small","aria-label":"Filtrer varsler",ref:r,onClick:f,className:u,children:[g,j]}),t[14]=f,t[15]=u,t[16]=p):p=t[16];let k;return t[17]!==p||t[18]!==m?(k=l.jsx($.New,{maxHeight:m,children:p}),t[17]=p,t[18]=m,t[19]=k):k=t[19],k},B=Y("/new/person/varsler"),M=t=>{const e=h.c(7),{tittel:s,feilteVarslinger:n}=t;let a;e[0]!==s?(a=l.jsx(T,{width:"8rem",children:l.jsx(D,{size:"medium",weight:"semibold",children:s})}),e[0]=s,e[1]=a):a=e[1];let r;e[2]!==n?(r=n.map(Ge),e[2]=n,e[3]=r):r=e[3];let i;return e[4]!==a||e[5]!==r?(i=l.jsxs(T,{gap:"1",children:[a,r]}),e[4]=a,e[5]=r,e[6]=i):i=e[6],i},L=t=>{const e=h.c(7),{tittel:s,tekst:n}=t;let a;e[0]!==s?(a=l.jsx(T,{width:"8rem",children:l.jsx(D,{size:"medium",weight:"semibold",children:s})}),e[0]=s,e[1]=a):a=e[1];let r;e[2]!==n?(r=l.jsx(D,{children:n}),e[2]=n,e[3]=r):r=e[3];let i;return e[4]!==a||e[5]!==r?(i=l.jsxs(T,{gap:"1",children:[a,r]}),e[4]=a,e[5]=r,e[6]=i):i=e[6],i},re=t=>{const e=h.c(14),{varsel:s,kanaler:n}=t;let a;e[0]!==s.tekst?(a=l.jsx(G,{level:"3",size:"xsmall",className:"mb-4",children:s.tekst}),e[0]=s.tekst,e[1]=a):a=e[1];let r;e[2]!==s.produsent?(r=K(s.produsent,P),e[2]=s.produsent,e[3]=r):r=e[3];let i;e[4]!==r?(i=l.jsx(L,{tittel:"Produsert av:",tekst:r}),e[4]=r,e[5]=i):i=e[5];let o;e[6]!==n?(o=K(n?.join(", "),P),e[6]=n,e[7]=o):o=e[7];let d;e[8]!==o?(d=l.jsx(L,{tittel:"Kanaler:",tekst:o}),e[8]=o,e[9]=d):d=e[9];let f;return e[10]!==a||e[11]!==i||e[12]!==d?(f=l.jsxs(V,{gap:"1",className:"p-2",children:[a,i,d]}),e[10]=a,e[11]=i,e[12]=d,e[13]=f):f=e[13],f},Je=t=>{const e=h.c(19),{varsel:s,kanaler:n}=t,a=s.varslingsTidspunkt;let r;e[0]!==n||e[1]!==s?(r=l.jsx(re,{varsel:s,kanaler:n}),e[0]=n,e[1]=s,e[2]=r):r=e[2];const i=a?.tidspunkt?`${I(a.tidspunkt)} - ${a.sendteKanaler.join(", ")}`:"-";let o;e[3]!==i?(o=l.jsx(L,{tittel:"Varslet: ",tekst:i}),e[3]=i,e[4]=o):o=e[4];let d;e[5]!==a?(d=a?.renotifikasjonTidspunkt&&l.jsx(L,{tittel:"Revarslet: ",tekst:`${I(a.renotifikasjonTidspunkt)} - ${a.renotifikasjonsKanaler.join(", ")}`}),e[5]=a,e[6]=d):d=e[6];let f;e[7]!==a?(f=a?.harFeilteVarslinger&&l.jsx(M,{tittel:"Varslingsfeil: ",feilteVarslinger:a.feilteVarsliner}),e[7]=a,e[8]=f):f=e[8];let m;e[9]!==a?(m=a?.harFeilteRevarslinger&&l.jsx(M,{tittel:"Revarslingsfeil: ",feilteVarslinger:a.feilteRevarslinger}),e[9]=a,e[10]=m):m=e[10];let c;e[11]!==o||e[12]!==d||e[13]!==f||e[14]!==m?(c=l.jsxs(V,{gap:"1",className:"px-2",children:[o,d,f,m]}),e[11]=o,e[12]=d,e[13]=f,e[14]=m,e[15]=c):c=e[15];let u;return e[16]!==r||e[17]!==c?(u=l.jsxs(l.Fragment,{children:[r,c]}),e[16]=r,e[17]=c,e[18]=u):u=e[18],u},Ue=t=>{const e=h.c(9),{varsler:s}=t,{id:n}=B.useSearch();let a;e[0]!==n?(a=c=>c.eventId===n,e[0]=n,e[1]=a):a=e[1];let r;r=s.find(a);const i=q(S),o=y.useRef(S),d=B.useNavigate();if(y.useEffect(()=>{const c=JSON.stringify(o.current)!==JSON.stringify(i),u=!r||!s.includes(r);c&&u&&be().clear()},[r,s,i]),!s.length){let c;return e[2]===Symbol.for("react.memo_cache_sentinel")?(c=l.jsx(l.Fragment,{}),e[2]=c):c=e[2],c}if(n&&!r){let c;return e[3]===Symbol.for("react.memo_cache_sentinel")?(c=l.jsx(V,{flexGrow:"1",minHeight:"0",className:"mt-6",children:l.jsx(X,{variant:"error",children:"Varselet du valgte, ble ikke funnet."})}),e[3]=c):c=e[3],c}if(!r&&!n&&(r=s[0],d({search:{id:r.eventId}})),!r){let c;return e[4]===Symbol.for("react.memo_cache_sentinel")?(c=l.jsx(l.Fragment,{}),e[4]=c):c=e[4],c}let f;e[5]!==r?(f=r&&l.jsx(Q,{padding:"4",children:r.erVarslerV2?l.jsx(Je,{varsel:r.event,kanaler:r.kanaler}):l.jsx(re,{varsel:r.event,kanaler:r.kanaler})}),e[5]=r,e[6]=f):f=e[6];let m;return e[7]!==f?(m=l.jsx(l.Fragment,{children:f}),e[7]=f,e[8]=m):m=e[8],m},Ye=()=>{const t=h.c(3),{varsler:e,isLoading:s}=w();let n;return t[0]!==s||t[1]!==e?(n=l.jsx(z,{boundaryName:"vaslerDetaljer",errorText:"Det oppstod en feil under visning av varsel",children:s?l.jsx(Z,{variant:"rectangle",height:"4rem"}):l.jsx(Ue,{varsler:e})}),t[0]=s,t[1]=e,t[2]=n):n=t[2],n};function Ge(t){return l.jsx("div",{children:l.jsxs(Se,{size:"small",showIcon:!0,children:[I(t.tidspunkt)," - ",t.kanal,": ",t.feilmelding]})},`${t.tidspunkt} - ${t.kanal}`)}const W=Y("/new/person/varsler"),Xe=t=>{const e=h.c(2),{varsel:s}=t;if(s.harFeilteVarsel){let a;return e[0]===Symbol.for("react.memo_cache_sentinel")?(a=l.jsx(O,{title:"Varsling feilet",variant:"error-moderate",size:"xsmall",children:l.jsx(Fe,{"aria-hidden":!0})}),e[0]=a):a=e[0],a}let n;return e[1]===Symbol.for("react.memo_cache_sentinel")?(n=l.jsx(O,{title:"Varsling vellykket",variant:"success-moderate",size:"xsmall",children:l.jsx(Te,{"aria-hidden":!0})}),e[1]=n):n=e[1],n},Ze=t=>{const e=h.c(35),{varsel:s}=t,n=W.useSearch().id,a=W.useNavigate(),r=y.useRef(null);let i,o;e[0]!==n||e[1]!==s.eventId?(i=()=>{n===s.eventId&&r.current?.focus()},o=[n,s.eventId],e[0]=n,e[1]=s.eventId,e[2]=i,e[3]=o):(i=e[2],o=e[3]),y.useEffect(i,o);let d;e[4]!==a||e[5]!==s.eventId?(d=()=>{a({search:{id:s.eventId},state:{umamiEvent:{name:_e.detaljvisningKlikket,data:{fane:"varsler",tekst:"vis varsel"}}}})},e[4]=a,e[5]=s.eventId,e[6]=d):d=e[6];const f=d;let m;e[7]!==f?(m=F=>{F.preventDefault(),f()},e[7]=f,e[8]=m):m=e[8];let c;e[9]!==f?(c=F=>{F.key!=="Enter"&&F.key!==" "&&F.key!=="Spacebar"||(F.preventDefault(),f())},e[9]=f,e[10]=c):c=e[10];const u=n===s.eventId&&"bg-ax-bg-accent-moderate-pressed border-ax-bg-accent-moderate-pressed";let g;e[11]!==u?(g=U("cursor-pointer hover:bg-[var(--ax-bg-accent-moderate-hover)] group",u),e[11]=u,e[12]=g):g=e[12];let x;e[13]!==s.tittel?(x=l.jsx(ye,{size:"small",as:"h3",children:s.tittel}),e[13]=s.tittel,e[14]=x):x=e[14];let v;e[15]!==s?(v=l.jsx(Xe,{varsel:s}),e[15]=s,e[16]=v):v=e[16];let j;e[17]!==x||e[18]!==v?(j=l.jsxs(T,{wrap:!1,justify:"space-between",align:"start",gap:"2",children:[x,v]}),e[17]=x,e[18]=v,e[19]=j):j=e[19];let p;e[20]===Symbol.for("react.memo_cache_sentinel")?(p=l.jsx(H,{children:"Varsel datoer:"}),e[20]=p):p=e[20];let k;e[21]!==s.datoer?(k=s.datoer.map(I).join(", "),e[21]=s.datoer,e[22]=k):k=e[22];let b;e[23]!==k?(b=l.jsxs(T,{gap:"2",children:[p,l.jsx(H,{children:k})]}),e[23]=k,e[24]=b):b=e[24];let _;e[25]!==j||e[26]!==b?(_=l.jsxs(V,{justify:"center",gap:"1",children:[j,b]}),e[25]=j,e[26]=b,e[27]=_):_=e[27];let E;e[28]!==_||e[29]!==g?(E=l.jsx(Q,{padding:"2",className:g,as:"li",children:_}),e[28]=_,e[29]=g,e[30]=E):E=e[30];let N;return e[31]!==E||e[32]!==m||e[33]!==c?(N=l.jsx(Ee,{ref:r,variant:"neutral",className:"hover:no-underline block",underline:!1,onClick:m,tabIndex:0,role:"link",onKeyDown:c,children:E}),e[31]=E,e[32]=m,e[33]=c,e[34]=N):N=e[34],N},Qe=()=>l.jsx(z,{boundaryName:"VarslerList",errorText:"Det oppstod en feil under visning av varsler liste",children:l.jsxs(V,{height:"100%",gap:"1",children:[l.jsx(qe,{}),l.jsx(et,{})]})}),et=()=>{const{varsler:t,isLoading:e,isError:s}=w(),n=Ne(106),a=Re({from:"/new/person/varsler",select:r=>r.id});if(!s)return!e&&!t.length?l.jsx(X,{variant:"info",role:"alert",children:"Ingen varsler funnet"}):l.jsx(l.Fragment,{children:e?l.jsx(V,{gap:"2",marginInline:"0 2",children:Array(8).keys().map(r=>l.jsx(Z,{variant:"rectangle",height:68},r))}):l.jsx(Le,{paginationSrHeading:{tag:"h3",text:"Varslerpaginering"},as:"section","aria-label":"varsler",pageSize:n,selectedKey:a,items:t,keyExtractor:r=>r.eventId,renderItem:({item:r})=>l.jsx(Ze,{varsel:r})})})},tt=()=>{const t=h.c(1);let e;return t[0]===Symbol.for("react.memo_cache_sentinel")?(e=l.jsx(z,{boundaryName:"varslerList",errorText:"Det oppstod en feil under lasting av varsler",children:l.jsx(st,{})}),t[0]=e):e=t[0],e},st=()=>{const t=h.c(8),{errorMessages:e}=w();let s;t[0]===Symbol.for("react.memo_cache_sentinel")?(s={xs:1,md:"max-content 1fr"},t[0]=s):s=t[0];let n;t[1]===Symbol.for("react.memo_cache_sentinel")?(n={xs:"auto",md:"hidden"},t[1]=n):n=t[1];let a;t[2]===Symbol.for("react.memo_cache_sentinel")?(a=l.jsxs(V,{height:"100%",gap:"1",width:"100%",maxWidth:{md:"16em"},overflow:{md:"hidden"},children:[l.jsx(G,{size:"small",visuallyHidden:!0,level:"2",children:"Varsler"}),l.jsx(Qe,{})]}),t[2]=a):a=t[2];let r;t[3]!==e?(r=l.jsx(Ie,{alerts:e}),t[3]=e,t[4]=r):r=t[4];let i;t[5]===Symbol.for("react.memo_cache_sentinel")?(i=l.jsx(V,{minHeight:"0",children:l.jsx(Ye,{})}),t[5]=i):i=t[5];let o;return t[6]!==r?(o=l.jsxs(we,{gap:"1",columns:s,height:"100%",width:"100%",overflow:n,children:[a,l.jsxs(V,{className:"min-h-100 md:min-h-0",children:[r,i]})]}),t[6]=r,t[7]=o):o=t[7],o},dt=$e("/new/person/varsler")({component:tt});export{dt as Route};
//# sourceMappingURL=varsler.lazy-Df0mBiRv.js.map
