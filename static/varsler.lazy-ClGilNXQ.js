import{bo as J,aM as $,m as q,N as x,Q as k,a4 as U,C as l,a3 as S,ap as g,aS as T,aw as I,bp as Q,bq as Y,f as X,bm as A,ar as L,a5 as y,a1 as N,br as z,a7 as D,bc as Z,a2 as v,bs as R,bt as ee,O as C,aa as te,bu as se,a6 as w,Y as le,be as re,bn as ae,J as ne}from"./main-CzQLl0ZF.js";import{S as O,C as K,H as ie}from"./index-19PQAOh0.js";import{g as oe,P as H,E as _,D as ce,F as de,S as me}from"./DatePeriodSelector-Cv1FCW6p.js";import{S as P}from"./Switch-vIniNqOt.js";import{G as fe}from"./GuidePanel-BYSkThyc.js";import{P as he}from"./index-DrUK-MZw.js";const B=oe(H.CUSTOM),M=["DITT_NAV","EPOST","SMS"],j=J({dateRange:B,failedVarslerOnly:!1,kanaler:M}),ue=$(t=>t(j).failedVarslerOnly,(t,e,r)=>{e(j,n=>({...n,failedVarslerOnly:r}))}),xe=$(t=>t(j).kanaler,(t,e,r)=>{e(j,n=>({...n,kanaler:n.kanaler?q.xor(n.kanaler,[r]):[r]}))}),ge=$(t=>t(j).dateRange,(t,e,r)=>{const n=r??B;e(j,s=>({...s,dateRange:n}))}),je=()=>{const t=x.c(3),[e,r]=I(ge);let n;return t[0]!==r||t[1]!==e?(n=l.jsx(ce,{resettable:!1,range:e,onChange:r,defaultPeriodType:H.CUSTOM}),t[0]=r,t[1]=e,t[2]=n):n=t[2],n},pe=()=>{const t=x.c(7),[e,r]=I(xe);let n;t[0]!==r?(n=o=>{r(o)},t[0]=r,t[1]=n):n=t[1];const s=n;let a;t[2]!==s||t[3]!==e?(a=M.map(o=>l.jsx(P,{size:"small",checked:e.includes(o),onChange:()=>s(o),children:o},o)),t[2]=s,t[3]=e,t[4]=a):a=t[4];let i;return t[5]!==a?(i=l.jsx(de,{size:"small",legend:"Varslingskanal",children:l.jsx(g,{gap:"2",children:a})}),t[5]=a,t[6]=i):i=t[6],i},ve=()=>{const t=x.c(8),[e,r]=I(ue);let n;t[0]!==r?(n=o=>{r(o)},t[0]=r,t[1]=n):n=t[1];const s=n;let a;t[2]!==e||t[3]!==s?(a=()=>s(!e),t[2]=e,t[3]=s,t[4]=a):a=t[4];let i;return t[5]!==e||t[6]!==a?(i=l.jsx(P,{size:"small",checked:e,onChange:a,children:"Vis varlser som feilet"}),t[5]=e,t[6]=a,t[7]=i):i=t[7],i},ke=()=>{const t=x.c(2),e=T(j);let r,n=0;e.failedVarslerOnly&&n++,e.kanaler&&e.kanaler.length>0&&n++,e.dateRange&&n++,r=n?`(${n})`:null;const s=r;let a;return t[0]!==s?(a=l.jsxs(l.Fragment,{children:["Filter ",s]}),t[0]=s,t[1]=a):a=t[1],a},Ve=()=>{const t=x.c(14),[e,r]=k.useState(!1),n=k.useRef(null);let s;t[0]===Symbol.for("react.memo_cache_sentinel")?(s=()=>{setTimeout(()=>{n.current&&r(n.current.classList.contains("aksel-expansioncard--open"))},0)},t[0]=s):s=t[0];const a=s;let i;t[1]!==e?(i=e?"100%":{},t[1]=e,t[2]=i):i=t[2];const o=e&&"max-h-full overflow-auto";let d;t[3]!==o?(d=U(o),t[3]=o,t[4]=d):d=t[4];let m;t[5]===Symbol.for("react.memo_cache_sentinel")?(m=l.jsx(_.Header,{className:"p-1",children:l.jsx(S.New,{paddingInline:"4",children:l.jsx(_.Title,{size:"small",children:l.jsx(ke,{})})})}),t[5]=m):m=t[5];let f;t[6]===Symbol.for("react.memo_cache_sentinel")?(f=l.jsx(S.New,{maxWidth:"17rem",children:l.jsx(pe,{})}),t[6]=f):f=t[6];let c;t[7]===Symbol.for("react.memo_cache_sentinel")?(c=l.jsx(S.New,{maxWidth:"17rem",children:l.jsx(ve,{})}),t[7]=c):c=t[7];let h;t[8]===Symbol.for("react.memo_cache_sentinel")?(h=l.jsx(_.Content,{className:"overflow-visible",children:l.jsxs(g,{gap:"2",children:[f,c,l.jsx(S.New,{children:l.jsx(je,{})})]})}),t[8]=h):h=t[8];let u;t[9]!==d?(u=l.jsxs(_,{size:"small","aria-label":"Filtrer varsler",ref:n,onClick:a,className:d,children:[m,h]}),t[9]=d,t[10]=u):u=t[10];let p;return t[11]!==i||t[12]!==u?(p=l.jsx(S.New,{marginInline:"0 2",maxHeight:i,children:u}),t[11]=i,t[12]=u,t[13]=p):p=t[13],p},Se=(t,e)=>{const{kanaler:r,failedVarslerOnly:n,dateRange:s}=e;if(!t||t.length===0)return[];let a=t;return r?.length>0&&(a=a.filter(i=>i.kanaler.some(o=>r.includes(o)))),n&&(a=a.filter(i=>i.harFeilteVarsel)),s?.from&&s?.to&&(a=a.filter(i=>i.datoer.map(d=>X(d)).some(d=>d.isAfter(s.from)&&d.isBefore(s.to)))),a??[]},G=()=>{const t=T(j),{data:e}=Q(),n=(e||{varsler:[]}).varsler.sort(Y(s=>s.forstBehandlet)).map(s=>be(s));return k.useMemo(()=>Se(n,t),[n,t])},be=t=>{const e=t.varslingsTidspunkt,n=`Notifikasjon${t.aktiv?"":" (Ferdigstilt)"}: ${t.tekst}`,s=t.eventId;if(!e||!e.tidspunkt){const d=[t.forstBehandlet],m=["DITT_NAV",...t.eksternVarslingKanaler];return{eventId:s,datoer:d,kanaler:m,tittel:n,sisteDato:d[0],erVarslerV2:!1,event:t}}const a=[e.tidspunkt];e.renotifikasjonTidspunkt&&a.unshift(e.renotifikasjonTidspunkt);const i=["DITT_NAV",...t.eksternVarslingKanaler,...e.renotifikasjonsKanaler].unique(),o=e.harFeilteVarslinger||e.harFeilteRevarslinger;return{eventId:s,datoer:a,kanaler:i,tittel:n,sisteDato:a[0],harFeilteVarsel:o,erVarslerV2:!0,event:t}},_e=A("/new/person/varsler"),E=t=>{const e=x.c(7),{tittel:r,feilteVarslinger:n}=t;let s;e[0]!==r?(s=l.jsx(v,{width:"8rem",children:l.jsx(R,{size:"medium",weight:"semibold",children:r})}),e[0]=r,e[1]=s):s=e[1];let a;e[2]!==n?(a=n.map(we),e[2]=n,e[3]=a):a=e[3];let i;return e[4]!==s||e[5]!==a?(i=l.jsxs(v,{gap:"1",children:[s,a]}),e[4]=s,e[5]=a,e[6]=i):i=e[6],i},F=t=>{const e=x.c(7),{tittel:r,tekst:n}=t;let s;e[0]!==r?(s=l.jsx(v,{width:"8rem",children:l.jsx(R,{size:"medium",weight:"semibold",children:r})}),e[0]=r,e[1]=s):s=e[1];let a;e[2]!==n?(a=l.jsx(R,{children:n}),e[2]=n,e[3]=a):a=e[3];let i;return e[4]!==s||e[5]!==a?(i=l.jsxs(v,{gap:"1",children:[s,a]}),e[4]=s,e[5]=a,e[6]=i):i=e[6],i},W=t=>{const e=x.c(14),{varsel:r,kanaler:n}=t;let s;e[0]!==r.tekst?(s=l.jsx(N,{level:"3",size:"xsmall",className:"mb-4",children:r.tekst}),e[0]=r.tekst,e[1]=s):s=e[1];let a;e[2]!==r.produsent?(a=z(r.produsent,D),e[2]=r.produsent,e[3]=a):a=e[3];let i;e[4]!==a?(i=l.jsx(F,{tittel:"Produsert av:",tekst:a}),e[4]=a,e[5]=i):i=e[5];let o;e[6]!==n?(o=z(n?.join(", "),D),e[6]=n,e[7]=o):o=e[7];let d;e[8]!==o?(d=l.jsx(F,{tittel:"Kanaler:",tekst:o}),e[8]=o,e[9]=d):d=e[9];let m;return e[10]!==s||e[11]!==i||e[12]!==d?(m=l.jsxs(g,{gap:"1",className:"p-2",children:[s,i,d]}),e[10]=s,e[11]=i,e[12]=d,e[13]=m):m=e[13],m},ye=t=>{const e=x.c(19),{varsel:r,kanaler:n}=t,s=r.varslingsTidspunkt;let a;e[0]!==n||e[1]!==r?(a=l.jsx(W,{varsel:r,kanaler:n}),e[0]=n,e[1]=r,e[2]=a):a=e[2];const i=s?.tidspunkt?`${y(s.tidspunkt)} - ${s.sendteKanaler.join(", ")}`:"-";let o;e[3]!==i?(o=l.jsx(F,{tittel:"Varslet: ",tekst:i}),e[3]=i,e[4]=o):o=e[4];let d;e[5]!==s?(d=s?.renotifikasjonTidspunkt&&l.jsx(F,{tittel:"Revarslet: ",tekst:`${y(s.renotifikasjonTidspunkt)} - ${s.renotifikasjonsKanaler.join(", ")}`}),e[5]=s,e[6]=d):d=e[6];let m;e[7]!==s?(m=s?.harFeilteVarslinger&&l.jsx(E,{tittel:"Varslingsfeil: ",feilteVarslinger:s.feilteVarsliner}),e[7]=s,e[8]=m):m=e[8];let f;e[9]!==s?(f=s?.harFeilteRevarslinger&&l.jsx(E,{tittel:"Revarslingsfeil: ",feilteVarslinger:s.feilteRevarslinger}),e[9]=s,e[10]=f):f=e[10];let c;e[11]!==o||e[12]!==d||e[13]!==m||e[14]!==f?(c=l.jsxs(g,{gap:"1",className:"px-2",children:[o,d,m,f]}),e[11]=o,e[12]=d,e[13]=m,e[14]=f,e[15]=c):c=e[15];let h;return e[16]!==a||e[17]!==c?(h=l.jsxs(l.Fragment,{children:[a,c]}),e[16]=a,e[17]=c,e[18]=h):h=e[18],h},Fe=()=>{const t=x.c(17),{id:e}=_e.useSearch(),r=G();let n;if(t[0]!==e||t[1]!==r){let c;t[3]!==e?(c=h=>h.eventId===e,t[3]=e,t[4]=c):c=t[4],n=r.find(c),t[0]=e,t[1]=r,t[2]=n}else n=t[2];const s=n,a=T(j),i=k.useRef(j);let o,d;if(t[5]!==a||t[6]!==s||t[7]!==r?(o=()=>{const c=JSON.stringify(i.current)!==JSON.stringify(a),h=!s||!r.includes(s);c&&h&&ee.clear()},d=[s,r,a],t[5]=a,t[6]=s,t[7]=r,t[8]=o,t[9]=d):(o=t[8],d=t[9]),k.useEffect(o,d),!r.length){let c;return t[10]===Symbol.for("react.memo_cache_sentinel")?(c=l.jsx(C,{className:"mt-2",variant:"info",children:"Fant ingen varsler"}),t[10]=c):c=t[10],c}if(!e){let c;return t[11]===Symbol.for("react.memo_cache_sentinel")?(c=l.jsx(v,{margin:"4",children:l.jsx(fe,{children:"Velg et varsel fra listen til venstre for å se detaljer."})}),t[11]=c):c=t[11],c}if(!s){let c;return t[12]===Symbol.for("react.memo_cache_sentinel")?(c=l.jsx(g,{flexGrow:"1",minHeight:"0",className:"mt-6",children:l.jsx(C,{variant:"error",children:"Varselet du valgte, ble ikke funnet."})}),t[12]=c):c=t[12],c}let m;t[13]!==s?(m=s&&l.jsx(K,{children:s.erVarslerV2?l.jsx(ye,{varsel:s.event,kanaler:s.kanaler}):l.jsx(W,{varsel:s.event,kanaler:s.kanaler})}),t[13]=s,t[14]=m):m=t[14];let f;return t[15]!==m?(f=l.jsx(l.Fragment,{children:m}),t[15]=m,t[16]=f):f=t[16],f},Ne=()=>{const t=x.c(1);let e;return t[0]===Symbol.for("react.memo_cache_sentinel")?(e=l.jsx(L,{boundaryName:"vaslerDetaljer",children:l.jsx(k.Suspense,{fallback:l.jsx(O,{variant:"rounded",height:"200"}),children:l.jsx(Fe,{})})}),t[0]=e):e=t[0],e};function we(t){return l.jsx("div",{children:l.jsxs(Z,{size:"small",showIcon:!0,children:[y(t.tidspunkt)," - ",t.kanal,": ",t.feilmelding]})},`${t.tidspunkt} - ${t.kanal}`)}const Re=A("/new/person/varsler"),$e=t=>{const e=x.c(24),{varsel:r,handleClick:n}=t,a=`cursor-pointer hover:hover:bg-ax-bg-neutral-moderate-hover group
                ${Re.useSearch().id===r.eventId?"bg-ax-bg-neutral-moderate ":""}`;let i;e[0]!==n||e[1]!==r.eventId?(i=()=>n(r.eventId),e[0]=n,e[1]=r.eventId,e[2]=i):i=e[2];let o;e[3]!==r.tittel?(o=l.jsx(N,{size:"xsmall",as:"h3",level:"3",children:r.tittel}),e[3]=r.tittel,e[4]=o):o=e[4];let d;e[5]===Symbol.for("react.memo_cache_sentinel")?(d=l.jsx(w,{size:"small",weight:"semibold",children:"Varsel datoer:"}),e[5]=d):d=e[5];let m;e[6]!==r.datoer?(m=r.datoer.map(y).join(", "),e[6]=r.datoer,e[7]=m):m=e[7];let f;e[8]!==m?(f=l.jsxs(v,{gap:"2",children:[d,l.jsx(w,{size:"small",children:m})]}),e[8]=m,e[9]=f):f=e[9];let c;e[10]===Symbol.for("react.memo_cache_sentinel")?(c=l.jsx(w,{size:"small",weight:"semibold",children:"Status:"}),e[10]=c):c=e[10];let h;e[11]!==r.harFeilteVarsel?(h=l.jsxs(v,{gap:"2",children:[c,r.harFeilteVarsel?l.jsx(te,{fontSize:"1.5rem",title:"Har feil"}):l.jsx(se,{fontSize:"1.5rem",title:"Ok"})]}),e[11]=r.harFeilteVarsel,e[12]=h):h=e[12];let u;e[13]!==o||e[14]!==f||e[15]!==h?(u=l.jsxs(g,{justify:"center",gap:"1",children:[o,f,h]}),e[13]=o,e[14]=f,e[15]=h,e[16]=u):u=e[16];let p;e[17]===Symbol.for("react.memo_cache_sentinel")?(p=l.jsx(le,{variant:"tertiary-neutral",size:"small",name:"Åpne","aria-label":"Åpne",icon:l.jsx(me,{"aria-hidden":!0,className:"translate-x-0 group-hover:translate-x-1 transition-transform"})}),e[17]=p):p=e[17];let V;e[18]!==u?(V=l.jsxs(v,{justify:"space-between",gap:"1",wrap:!1,children:[u,p]}),e[18]=u,e[19]=V):V=e[19];let b;return e[20]!==a||e[21]!==V||e[22]!==i?(b=l.jsx(K,{padding:"2",className:a,onClick:i,as:"li",children:V}),e[20]=a,e[21]=V,e[22]=i,e[23]=b):b=e[23],b},Te=()=>l.jsxs(g,{minHeight:"0",gap:"2",children:[l.jsx(Ve,{}),l.jsx(L,{boundaryName:"varslerList",children:l.jsx(k.Suspense,{fallback:l.jsx(g,{gap:"2",marginInline:"0 2",children:Array(8).keys().map(t=>l.jsx(O,{variant:"rounded",height:68,width:"100%"},t))}),children:l.jsx(Ie,{})})})]}),Ie=()=>{const t=x.c(14),e=G();let r;t[0]===Symbol.for("react.memo_cache_sentinel")?(r={from:"/new/person/varsler"},t[0]=r):r=t[0];const n=re(r);let s;t[1]!==n?(s=h=>{n({search:{id:h}})},t[1]=n,t[2]=s):s=t[2];const a=s;let i;t[3]===Symbol.for("react.memo_cache_sentinel")?(i={from:"/new/person/varsler",select:ze},t[3]=i):i=t[3];const o=ae(i),d=e.length===1?"varsel":"varsler";let m;t[4]!==d||t[5]!==e.length?(m=l.jsxs(N,{className:"pl-1",size:"xsmall",level:"2",children:[e.length," ",d]}),t[4]=d,t[5]=e.length,t[6]=m):m=t[6];let f;t[7]!==a||t[8]!==o||t[9]!==e?(f=e.length>0&&l.jsx(he,{selectedKey:o,items:e,keyExtractor:De,renderItem:h=>{const{item:u}=h;return l.jsx($e,{varsel:u,handleClick:a})}}),t[7]=a,t[8]=o,t[9]=e,t[10]=f):f=t[10];let c;return t[11]!==m||t[12]!==f?(c=l.jsxs(l.Fragment,{children:[m,f]}),t[11]=m,t[12]=f,t[13]=c):c=t[13],c};function ze(t){return t.id}function De(t){return t.eventId}const Ce=()=>{const t=x.c(5);let e;t[0]===Symbol.for("react.memo_cache_sentinel")?(e={xs:1,md:"max-content 1fr"},t[0]=e):e=t[0];let r;t[1]===Symbol.for("react.memo_cache_sentinel")?(r={xs:"scroll",md:"hidden"},t[1]=r):r=t[1];let n;t[2]===Symbol.for("react.memo_cache_sentinel")?(n=l.jsxs(g,{height:"100%",gap:"1",width:"100%",maxWidth:{md:"16em"},overflow:{md:"hidden"},children:[l.jsx(N,{size:"small",children:"Varsler"}),l.jsx(Te,{})]}),t[2]=n):n=t[2];let s;t[3]===Symbol.for("react.memo_cache_sentinel")?(s={xs:"hidden",md:"scroll"},t[3]=s):s=t[3];let a;return t[4]===Symbol.for("react.memo_cache_sentinel")?(a=l.jsxs(ie,{gap:"1",columns:e,height:"100%",width:"100%",overflow:r,children:[n,l.jsx(g,{className:"min-h-100 md:min-h-0",overflow:s,children:l.jsx(g,{minHeight:"0",className:"mt-6",children:l.jsx(Ne,{})})})]}),t[4]=a):a=t[4],a},Pe=ne("/new/person/varsler")({component:Ce});export{Pe as Route};
//# sourceMappingURL=varsler.lazy-ClGilNXQ.js.map
