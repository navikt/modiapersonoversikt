import{$ as g,aw as P,dN as W,Y as c,dO as q,aq as Q,b2 as I,b_ as H,b$ as O,c0 as G,ay as T,t as R,c1 as J,a1 as S,aW as Y,ap as L,c2 as $,aA as b,as as w,ai as A,c4 as D,c5 as C,ch as X,c3 as Z,c6 as ee,c7 as te,c8 as se,c9 as ae,dP as ne,z as v,aK as re,dL as B,bY as le,bZ as oe,bX as ie,d as ce,dQ as de,i as me,C as U,y as ue,dR as fe,dS as ke,a0 as V}from"./main-b-impCUS.js";import{S as he}from"./Switch-C5Mm46Du.js";import{S as ge}from"./Search-CvnG5aGO.js";const Se=["application/pdf",""],pe=e=>Se.includes(e.toLowerCase()),xe=(e,t,a)=>{const s=g.c(10);let l;s[0]!==t||s[1]!==e?(l=["document-blob",e,t],s[0]=t,s[1]=e,s[2]=l):l=s[2];let n;s[3]!==t||s[4]!==a||s[5]!==e?(n=async()=>{const o=await fetch(e,W({fnr:t}));if(!o.ok){a(o.status);return}const u=o.headers.get("Content-Type")||"application/pdf",m=await o.blob();return{blobUrl:URL.createObjectURL(m),contentType:u}},s[3]=t,s[4]=a,s[5]=e,s[6]=n):n=s[6];let r;return s[7]!==l||s[8]!==n?(r={queryKey:l,queryFn:n},s[7]=l,s[8]=n,s[9]=r):r=s[9],P(r)},be=e=>{const t=g.c(9),{url:a,fnr:s,onError:l,children:n}=e,{data:r,isLoading:o,isError:u}=xe(a,s,l);if(o){let i;return t[0]===Symbol.for("react.memo_cache_sentinel")?(i=c.jsx(q,{}),t[0]=i):i=t[0],i}if(u||!r){let i;return t[1]!==n?(i=c.jsx(c.Fragment,{children:n}),t[1]=n,t[2]=i):i=t[2],i}const{blobUrl:m,contentType:f}=r;if(!pe(f)){let i;return t[3]!==m?(i=c.jsx(Q,{gap:"2",children:c.jsxs(I,{size:"small",weight:"semibold",children:["Vedlegget kan ikke vises i nettleseren. Last ned filen for å se innholdet."," ",c.jsx("a",{href:m,children:"Last ned dokument"})]})}),t[3]=m,t[4]=i):i=t[4],i}let d;return t[5]!==m||t[6]!==n||t[7]!==f?(d=c.jsx("div",{className:"flex justify-center items-center w-full h-screen bg-gray-100 overflow-hidden",children:c.jsx("object",{data:m,type:f,className:"w-full h-full border-none",children:n})}),t[5]=m,t[6]=n,t[7]=f,t[8]=d):d=t[8],d},K=H(O.CUSTOM),h=G({dateRange:K,temaer:[],status:[],avsender:[]}),ve=T(e=>e(h).temaer,(e,t,a)=>{t(h,s=>({...s,temaer:s.temaer?R.xor(s.temaer,[a]):[a]}))}),Te=T(e=>e(h).saksId,(e,t,a)=>{t(h,s=>({...s,saksId:a.length?a:void 0}))}),Pe=T(e=>e(h).avsender,(e,t,a)=>{t(h,s=>({...s,avsender:R.xor(s.avsender,[a])}))}),je=T(e=>e(h).status,(e,t,a)=>{t(h,s=>({...s,status:R.xor(s.status,[a])}))}),ye=T(e=>e(h).dateRange,(e,t,a)=>{const s=a??K;t(h,l=>({...l,dateRange:s}))}),Ee=()=>{const e=g.c(12),[t,a]=S.useState(""),[s,l]=A(Te);let n,r;e[0]!==s?(n=()=>{a(s??"")},r=[s],e[0]=s,e[1]=n,e[2]=r):(n=e[1],r=e[2]),S.useEffect(n,r);let o;e[3]!==l?(o=k=>{l(k),D("saker",C.SOK)},e[3]=l,e[4]=o):o=e[4];const u=o;let m;e[5]!==u?(m=R.debounce(u,500),e[5]=u,e[6]=m):m=e[6];const f=m;let d;e[7]!==f?(d=k=>{a(k),f(k)},e[7]=f,e[8]=d):d=e[8];let i;return e[9]!==t||e[10]!==d?(i=c.jsx(ge,{size:"small",label:"Saksnummer",variant:"secondary",hideLabel:!1,value:t,onChange:d}),e[9]=t,e[10]=d,e[11]=i):i=e[11],i},Fe=()=>{const e=g.c(3),[t,a]=A(ye);let s;return e[0]!==a||e[1]!==t?(s=c.jsx(Z,{range:t,onChange:a,defaultPeriodType:O.CUSTOM}),e[0]=a,e[1]=t,e[2]=s):s=e[2],s},Ne=()=>{const[e,t]=A(ve),a=Ue(),s=S.useCallback(l=>{t(l),D("saker",C.TEMA)},[e]);return c.jsx(X,{size:"small",label:"Tema",options:a.map(l=>({label:`${l.temanavn} [${l.temakode}]`,value:l.temakode})),isMultiSelect:!0,selectedOptions:e,onToggleSelected:s})},$e=()=>{const e=g.c(7),[t,a]=A(je);let s;e[0]!==a?(s=o=>{a(o),D("saker",C.STATUS)},e[0]=a,e[1]=s):s=e[1];const l=s;let n;e[2]!==l||e[3]!==t?(n=Ce.map(o=>c.jsx(he,{size:"small",checked:t.includes(o),onChange:()=>l(o),children:c.jsx("p",{className:"capitalize font-medium",children:o})},o)),e[2]=l,e[3]=t,e[4]=n):n=e[4];let r;return e[5]!==n?(r=c.jsx(ee,{size:"small",legend:"Status",children:c.jsx(w,{gap:"2",children:n})}),e[5]=n,e[6]=r):r=e[6],r},Re=()=>{const e=g.c(6),{data:t}=_e();let a;e[0]!==t?.saker?(a=t?.saker??[],e[0]=t?.saker,e[1]=a):a=e[1];const s=a,l=s.length===1?"sak":"saker";let n;e[2]===Symbol.for("react.memo_cache_sentinel")?(n=c.jsx(I,{visuallyHidden:!0,children:"funnet"}),e[2]=n):n=e[2];let r;return e[3]!==s.length||e[4]!==l?(r=c.jsxs(c.Fragment,{children:["Filter (",s.length," ",l,")",n]}),e[3]=s.length,e[4]=l,e[5]=r):r=e[5],r},We=()=>{const e=g.c(21),t=J(h),[a,s]=S.useState(!1),l=Y(),n=S.useRef(null);let r;e[0]!==t?(r=()=>{t(te)},e[0]=t,e[1]=r):r=e[1];let o;e[2]!==l?(o=[l],e[2]=l,e[3]=o):o=e[3],S.useEffect(r,o);let u;e[4]!==a?(u=()=>{setTimeout(()=>{if(!n.current)return;const _=n.current.classList.contains("aksel-expansioncard--open");s(_),_!==a&&(_?se("sakerfilter"):ae("sakerfilter"))},0)},e[4]=a,e[5]=u):u=e[5];const m=u,f=a&&"max-h-full";let d;e[6]!==f?(d=L(f),e[6]=f,e[7]=d):d=e[7];const i=a&&"max-h-full overflow-auto";let k;e[8]!==i?(k=L("rounded-sm",i),e[8]=i,e[9]=k):k=e[9];let p;e[10]===Symbol.for("react.memo_cache_sentinel")?(p=c.jsx($.Header,{className:"py-0 pr-0 hover:rounded-sm",children:c.jsx($.Title,{size:"small",as:"h3",className:"text-ax-medium",role:"alert",children:c.jsx(Re,{})})}),e[10]=p):p=e[10];let j;e[11]===Symbol.for("react.memo_cache_sentinel")?(j=c.jsx(b.New,{maxWidth:"15rem",children:c.jsx(Ee,{})}),e[11]=j):j=e[11];let y;e[12]===Symbol.for("react.memo_cache_sentinel")?(y=c.jsx(b.New,{maxWidth:"15rem",children:c.jsx(Ne,{})}),e[12]=y):y=e[12];let E;e[13]===Symbol.for("react.memo_cache_sentinel")?(E=c.jsx(b.New,{maxWidth:"15rem",children:c.jsx($e,{})}),e[13]=E):E=e[13];let F;e[14]===Symbol.for("react.memo_cache_sentinel")?(F=c.jsx($.Content,{className:"overflow-visible",children:c.jsxs(w,{gap:"2",children:[j,y,E,c.jsx(b.New,{children:c.jsx(Fe,{})})]})}),e[14]=F):F=e[14];let x;e[15]!==m||e[16]!==k?(x=c.jsxs($,{onClick:m,ref:n,className:k,size:"small","aria-label":"Filtrer saker",children:[p,F]}),e[15]=m,e[16]=k,e[17]=x):x=e[17];let N;return e[18]!==x||e[19]!==d?(N=c.jsx(b.New,{className:d,children:x}),e[18]=x,e[19]=d,e[20]=N):N=e[20],N},Ae=(e,t)=>{const{saksId:a,temaer:s,status:l,dateRange:n}=t;if(!e||e.length===0)return[];let r=e;return a&&(r=r.filter(o=>(o.fagsaksnummer||o.saksid).startsWith(a))),s?.length&&(r=r.filter(o=>s.includes(o.temakode))),l?.length&&(r=r.filter(o=>l.includes(o.avsluttet?z:M))),n?.from&&n?.to&&(r=r.filter(o=>{const u=ce(o.opprettet);return u.isSameOrAfter(n.from)&&u.isSameOrBefore(n.to)})),r},_e=()=>{const e=g.c(21),t=re(h),a=B();let s;e[0]!==a?.data?.saker?(s=a?.data?.saker??[],e[0]=a?.data?.saker,e[1]=s):s=e[1];const l=s;let n;e[2]!==a?(n=le(a,oe("saker og dokumenter")),e[2]=a,e[3]=n):n=e[3];let r;e[4]!==n?(r=[n],e[4]=n,e[5]=r):r=e[5];const o=r;let u,m,f;if(e[6]!==t||e[7]!==l||e[8]!==a){const p=l.toSorted(ie(Be));f=a,u=a?.data,m=Ae(p,t)??[],e[6]=t,e[7]=l,e[8]=a,e[9]=u,e[10]=m,e[11]=f}else u=e[9],m=e[10],f=e[11];let d;e[12]!==u||e[13]!==m?(d={...u,saker:m},e[12]=u,e[13]=m,e[14]=d):d=e[14];let i;e[15]!==o?(i=o.filter(Boolean),e[15]=o,e[16]=i):i=e[16];let k;return e[17]!==f||e[18]!==d||e[19]!==i?(k={...f,data:d,errorMessages:i},e[17]=f,e[18]=d,e[19]=i,e[20]=k):k=e[20],k},Ue=()=>{const e=g.c(2),{data:t}=B();let a;e[0]!==t?.temaer?(a=t?.temaer??[],e[0]=t?.temaer,e[1]=a):a=e[1];const s=a;let l;return l=s,l},we=e=>{switch(e){case 401:case 403:return"Du har ikke tilgang til dette dokumentet.";case 404:return"Dokument ikke funnet.";default:return`Ukjent feil ved henting av dokument. Kontakt brukerstøtte. Feilkode: ${e}`}},De=e=>{const{journalpost:t,dokument:a}=de(e);return`${me}/saker/dokument/${t}/${a}`},qe=e=>`${e.temakode}-${e.fagsaksnummer}`,Qe=[{value:v.NAV,label:"Nav"},{value:v.SLUTTBRUKER,label:"Bruker"},{value:v.EKSTERN_PART,label:"Ekstern"},{value:v.UKJENT,label:"Ukjent"}],M="åpen",z="avsluttet",Ce=[M,z],Le="ALLE",He=(e,t,a)=>{const s=t?Ve(t):"";return`${e}/#/startsok?tema=${s}&gt=${a||""}`},Ve=e=>e.temakode!==Le?e.temakode:e.tilhorendeDokumenter.reduce((a,s)=>(a.includes(s.temakode)||a.push(s.temakode),a),[]).join(","),Ge=(e,t)=>!t.logiskDokument&&Ie(e),Ie=e=>{const t=e.tilhorendeFagsaksid||e.tilhorendeSaksid||"";return e.feil?.feilmelding!==ne.SIKKERHETSBEGRENSNING&&t.length!==0},Je=(e,t)=>{switch(t.retning){case U.INN:return t.avsender===v.SLUTTBRUKER?`Fra ${e}`:`Fra ${t.navn}`;case U.UT:return Oe(t.mottaker,t.navn);case U.INTERN:return"Notat";default:return"Ukjent kommunikasjonsretning"}},Oe=(e,t)=>`Fra NAV ${e===ue.SLUTTBRUKER?"":`(Sendt til ${t})`}`;function Ye(e){const t=e?.navn.firstOrNull();return t?t.fornavn+(t.mellomnavn?` ${t.mellomnavn} `:" ")+t.etternavn:"Ukjent navn"}function Xe(e,t){return`journalpost=${e}&dokument=${t}`}function Be(e){return e.opprettet||new Date(0)}const Ze=e=>{const t=g.c(10),{fnr:a,url:s}=e,[l,n]=S.useState("");let r;t[0]===Symbol.for("react.memo_cache_sentinel")?(r=i=>n(we(i)),t[0]=r):r=t[0];const o=r;if(fe()){let i;return t[1]===Symbol.for("react.memo_cache_sentinel")?(i=c.jsx(V,{variant:"info",children:"Kan ikke vise dokumenter i Internet Explorer. Prøv chrome"}),t[1]=i):i=t[1],i}let u;t[2]!==s?(u=ke(De(s)),t[2]=s,t[3]=u):u=t[3];const m=u;let f;t[4]!==l?(f=c.jsx(w,{align:"stretch",width:"100%",children:c.jsx(V,{variant:"warning",children:l})}),t[4]=l,t[5]=f):f=t[5];let d;return t[6]!==a||t[7]!==f||t[8]!==m?(d=c.jsx(be,{url:m,fnr:a,onError:o,children:f}),t[6]=a,t[7]=f,t[8]=m,t[9]=d):d=t[9],d};export{Ze as D,We as S,qe as a,Pe as b,He as c,Ge as d,Qe as e,Ue as f,Xe as g,Ye as h,h as s,Je as t,_e as u};
//# sourceMappingURL=DokumentVisning-CAAhUsJC.js.map
